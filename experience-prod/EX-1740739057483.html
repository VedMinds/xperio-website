<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Xperio : Experience Slow Living: Sustainable Farm Stay Near Bengaluru</title>

  <meta name="description"
    content="Discover the best travel experiences with Xperio Travel. Adventure, relaxation, and culture—find your next trip today!">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://xperio.travel/favicon.ico">
   <!-- Primary favicon -->
   <link rel="icon" href="https://xperio.travel/favicon.ico">
    
   <!-- Standard favicon -->
   <link rel="shortcut icon" href="https://xperio.travel/favicon.ico">
   
   <!-- Sizes for different devices -->
   <link rel="icon" type="image/x-icon" href="https://xperio.travel/favicon.ico">
   <link rel="icon" type="image/png" sizes="16x16" href="https://xperio.travel/favicon.ico">
   <link rel="icon" type="image/png" sizes="32x32" href="https://xperio.travel/favicon.ico">
   
   <!-- Apple Touch Icon for iOS devices -->
   <link rel="apple-touch-icon" href="https://xperio.travel/favicon.ico">
   <link rel="apple-touch-icon" sizes="180x180" href="https://xperio.travel/favicon.ico">
  
  <meta name="image"
    content="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/Pn7sE1ttli8pra7.jpeg&w=300">

  <meta itemprop="name" content="Xperio : Experience Slow Living: Sustainable Farm Stay Near Bengaluru">
  <meta itemprop="description"
    content="Discover the best travel experiences with Xperio Travel. Adventure, relaxation, and culture—find your next trip today!">
  <meta itemprop="image"
    content="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/Pn7sE1ttli8pra7.jpeg&w=300">

  <link rel="icon" type="image/vnd.microsoft.icon"
    href="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/Pn7sE1ttli8pra7.jpeg&w=300" />


  <meta property="og:title" content="Xperio : Experience Slow Living: Sustainable Farm Stay Near Bengaluru" />
  <meta property="og:description"
    content="Discover the best travel experiences with Xperio Travel. Adventure, relaxation, and culture—find your next trip today!" />
  <meta property="og:image"
    content="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/Pn7sE1ttli8pra7.jpeg&w=300" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="xperio" />

  <!-- Stylesheet -->
  <link rel="stylesheet" href="https://xperio.travel/css/ex-styles.css">


  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7V47FQ8RG6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }

    gtag('js', new Date());
    gtag('config', 'G-7V47FQ8RG6', {
      'page_path': window.location.pathname + window.location.search
    });
    const exId = "EX-1740739057483";
    if (exId) {
      gtag('event', 'view_experience', {
        'experience_id': exId
      });
    }
  </script>

  <style>
    body {
      font-family: "Roboto", sans-serif;
      margin: 0;
      padding: 15px;
      color: #333;
      background-color: #f9f9f9;
      line-height: 1.6;
    }

    .floating-book-button {
      position: fixed;
      bottom: 24px;
      right: calc(50% - 530px);
      transform: translateX(50%);
      background: linear-gradient(135deg, #ff385c, #e31c5f);
      color: white;
      padding: 12px 24px;
      border-radius: 32px;
      box-shadow: 0 4px 20px rgba(255, 56, 92, 0.25);
      z-index: 1000;
      border: none;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(8px);
      min-width: 180px;
    }

    .floating-book-button:hover {
      box-shadow: 0 8px 28px rgba(255, 56, 92, 0.35);
      background: linear-gradient(135deg, #ff4d6d, #ff385c);
    }

    .floating-book-button:active {
      transform: translateY(-2px) scale(0.98);
    }

    .button-icon {
      font-size: 20px;
      animation: pulse 2s infinite;
    }

    .button-text {
      font-size: 16px;
      letter-spacing: 0.5px;
    }

    .button-price {
      font-size: 14px;
      opacity: 0.9;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 8px;
      border-radius: 16px;
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }

      100% {
        transform: scale(1);
      }
    }

    @media (max-width: 768px) {
      .floating-book-button {
        bottom: 16px;
        right: 16px;
        transform: none;
        min-width: 140px;
        padding: 10px 20px;
        font-size: 14px;
        gap: 8px;
      }

      .floating-book-button:hover {
        transform: translateY(-3px) scale(1.02);
      }

      .button-icon {
        font-size: 16px;
      }

      .button-text {
        font-size: 14px;
      }
    }

    @media (max-width: 380px) {
      .floating-book-button {
        bottom: 12px;
        right: 12px;
        min-width: 120px;
        padding: 8px 16px;
        font-size: 13px;
        gap: 6px;
      }

      .button-icon {
        font-size: 14px;
      }

      .button-text {
        font-size: 13px;
      }
    }
    .xp-reviews-section {
      margin: 30px 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    }

    .xp-section-title {
      font-size: 22px;
      font-weight: 600;
      color: #333;
    }

    .xp-reviews-container {
      position: relative;
      width: 100%;
      padding: 10px 0;
    }

    .xp-reviews-scroll {
      display: flex;
      overflow-x: auto;
      scroll-behavior: smooth;
      padding: 10px 5px;
      gap: 20px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .xp-reviews-scroll::-webkit-scrollbar {
      display: none;
    }

    .xp-review-card {
      flex: 0 0 auto;
      width: 320px;
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 16px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .xp-review-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .xp-review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .xp-reviewer-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .xp-reviewer-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      overflow: hidden;
      background-color: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: #555;
      flex-shrink: 0;
    }

    .xp-reviewer-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .xp-avatar-placeholder {
      font-size: 18px;
      text-transform: uppercase;
    }

    .xp-reviewer-details {
      display: flex;
      flex-direction: column;
    }

    .xp-reviewer-name {
      font-weight: 600;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 150px;
    }

    .xp-review-date {
      font-size: 12px;
      color: #777;
    }

    .xp-rating {
      color: #ff9800;
      font-size: 18px;
      letter-spacing: 2px;
      flex-shrink: 0;
    }

    .xp-review-content {
      margin-bottom: 12px;
      font-size: 14px;
      line-height: 1.5;
      max-height: 100px;
      overflow-y: auto;
      color: #444;
    }

    .xp-review-images {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      position: relative;
      flex-wrap: wrap;
    }

    .xp-review-image-container {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      transition: transform 0.2s ease;
    }

    .xp-review-image-container:hover {
      transform: scale(1.05);
    }

    .xp-review-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .xp-more-images-container {
      position: relative;
    }

    .xp-more-images {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      font-size: 14px;
      font-weight: bold;
      border-radius: 8px;
    }

    .xp-review-highlights {
      font-size: 12px;
      color: #555;
    }

    .xp-highlight-item {
      margin-bottom: 4px;
      line-height: 1.4;
    }

    .xp-scroll-buttons {
      position: absolute;
      top: 50%;
      width: 100%;
      display: flex;
      justify-content: space-between;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 1;
    }

    .xp-scroll-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: white;
      border: 1px solid #ddd;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      pointer-events: auto;
      transition: all 0.2s ease;
    }

    .xp-scroll-button:hover {
      background-color: #f5f5f5;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .xp-scroll-button.left {
      margin-left: -15px;
    }

    .xp-scroll-button.right {
      margin-right: -15px;
    }

    /* Image Gallery Modal */
    .xp-image-gallery-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 10px;
    }

    .xp-gallery-content {
      position: relative;
      width: 95%;
      max-width: 1000px;
      background-color: #000;
      border-radius: 8px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 90vh;
    }

    .xp-close-modal {
      position: absolute;
      top: 15px;
      right: 20px;
      color: white;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1010;
      height: 40px;
      width: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
    }

    .xp-gallery-main-image {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background-color: #000;
    }

    .xp-gallery-main-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      touch-action: pan-y pinch-zoom;
    }

    .xp-gallery-navigation {
      display: flex;
      padding: 12px;
      background-color: #111;
      position: relative;
      align-items: center;
    }

    .xp-gallery-nav-button {
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s;
      z-index: 2;
      -webkit-tap-highlight-color: transparent;
    }

    .xp-gallery-nav-button:hover {
      background-color: rgba(255, 255, 255, 0.4);
    }

    .xp-gallery-thumbnails {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 0 10px;
      scrollbar-width: thin;
      scrollbar-color: #666 #333;
      flex: 1;
      justify-content: center;
      -webkit-overflow-scrolling: touch;
    }

    .xp-gallery-thumbnails::-webkit-scrollbar {
      height: 5px;
    }

    .xp-gallery-thumbnails::-webkit-scrollbar-track {
      background: #333;
    }

    .xp-gallery-thumbnails::-webkit-scrollbar-thumb {
      background-color: #666;
      border-radius: 10px;
    }

    .xp-gallery-thumbnail {
      width: 60px;
      height: 60px;
      border-radius: 4px;
      overflow: hidden;
      opacity: 0.6;
      cursor: pointer;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .xp-gallery-thumbnail.active {
      opacity: 1;
      border: 2px solid white;
    }

    .xp-gallery-thumbnail:hover {
      opacity: 0.9;
    }

    .xp-gallery-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .xp-image-counter {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background-color: rgba(0, 0, 0, 0.6);
      color: white;
      padding: 5px 10px;
      border-radius: 15px;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      .xp-review-card {
        width: 300px;
      }

      .xp-gallery-content {
        width: 95%;
        height: 80vh;
      }

      .xp-gallery-thumbnail {
        width: 50px;
        height: 50px;
      }

      .xp-scroll-button {
        width: 36px;
        height: 36px;
        font-size: 16px;
      }

      .xp-scroll-button.left {
        margin-left: -10px;
      }

      .xp-scroll-button.right {
        margin-right: -10px;
      }

      .xp-close-modal {
        top: 10px;
        right: 10px;
      }

      .xp-image-gallery-modal {
        width: 96%;
      }
    }

    @media (max-width: 480px) {
      .xp-review-card {
        width: 85vw;
        max-width: 300px;
        padding: 12px;
      }

      .xp-reviewer-avatar {
        width: 35px;
        height: 35px;
      }

      .xp-reviewer-name {
        max-width: 120px;
      }

      .xp-gallery-navigation {
        padding: 8px 5px;
      }

      .xp-gallery-thumbnail {
        width: 45px;
        height: 45px;
      }

      .xp-gallery-nav-button {
        width: 36px;
        height: 36px;
      }

      .xp-review-image-container {
        width: 65px;
        height: 65px;
      }

      .xp-image-counter {
        bottom: 15px;
        left: 15px;
        font-size: 12px;
      }

      .xp-scroll-buttons {
        display: none;
      }
    }

    @media (max-width: 380px) {
      .xp-review-card {
        width: 95vw;
        padding: 10px;
      }

      .xp-review-images {
        gap: 6px;
      }

      .xp-review-image-container {
        width: 60px;
        height: 60px;
      }

      .xp-gallery-thumbnail {
        width: 40px;
        height: 40px;
      }
    }

    @media (hover: none) {
      .xp-gallery-main-image {
        touch-action: pan-y pinch-zoom;
      }

      .xp-gallery-nav-button {
        width: 44px;
        height: 44px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div id="app"></div>
  </div>

  <div class="dialog-overlay" id="bookingDialog">
    <div class="dialog-form">
      <div class="dialog-header">
        <h3>Book a memorable journey with Xperio</h3>
        <button class="close-button" onclick="closeDialog()">&times;</button>
      </div>
      <form id="bookingForm" onsubmit="submitBooking(event)" novalidate>
        <div class="form-group">
          <label for="slotRange">Select Time Slot *</label>
          <select id="slotRange" class="slot-range-select" required>
            <option value=""></option>
          </select>
        </div>
        <div class="form-group">
          <label for="firstName">First Name *</label>
          <input type="text" id="firstName" required minlength="2" pattern="[A-Za-z\s]+"
            placeholder="Enter Your First Name" />
        </div>
        <div class="form-group">
          <label for="lastName">Last Name *</label>
          <input type="text" id="lastName" required minlength="2" pattern="[A-Za-z\s]+"
            placeholder="Enter Your Last Name" />
        </div>
        <div class="form-group">
          <label for="phone">Phone *</label>
          <input type="tel" id="phone" required pattern="[0-9]{10}" placeholder="Enter Your Phone Number" />
        </div>
        <div class="form-group">
          <label for="email">Email *</label>
          <input type="email" id="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
            placeholder="Enter Your Email" />
        </div>
        <div class="form-group">
          <label for="guestCount">Number Of Guests *</label>
          <select id="guestCount" required>
            <option value="">Select Number Of Guests</option>
          </select>
        </div>
        <input type="hidden" id="slotId" name="slotId" required />
        <button type="submit" class="submit-button">
          <span>Submit Enquiry</span>
        </button>
      </form>
    </div>
  </div>

  <button class="floating-book-button" id="bookNowButton" onclick="openDialog()">
    <span class="button-icon">📅</span>
    <span class="button-text">Enquire Now</span>
  </button>


  <div id="hostModal" class="host-modal-overlay">
    <div class="host-modal-content">
      <div class="host-modal-header">
        <h3>Host Profile</h3>
        <button class="modal-close-button" onclick="closeHostModal()">&times;</button>
      </div>
      <div class="host-modal-body">
        <div class="host-profile-section">
          <img id="modalHostImage" src="" alt="xperio-host" class="modal-host-image">
          <div class="host-info">
            <h4 id="modalHostName" style="padding-top: 2rem;"></h4>
            <div class="host-rating" id="modalHostRating">
              <span class="star-rating"></span>
              <span class="rating-count"></span>
            </div>
          </div>
        </div>

        <div class="host-description">
          <h5>About the Host</h5>
          <p id="modalHostBrief"></p>
        </div>

        <!-- <div class="host-reviews" id="modalHostReviews">
          <h5>Guest Reviews</h5>
          <div class="reviews-container"></div>
        </div> -->
      </div>
    </div>
  </div>

  <div class="lightbox" id="lightbox">
    <div class="lightbox-content">
      <img src="" alt="xperio-lightbox-image" class="lightbox-image" id="lightbox-image">
      <div class="lightbox-controls">
        <button class="lightbox-nav prev-button">❮</button>
        <button class="lightbox-nav next-button">❯</button>
        <button class="lightbox-close">&times;</button>
        <div class="zoom-controls">
          <button class="zoom-in">+</button>
          <button class="zoom-out">-</button>
        </div>
        <div class="lightbox-counter"></div>
      </div>
    </div>
  </div>

  <script>
    async function initializeExperience() {
      const data = await fetchExperienceData();
      if (data) {
        updateMetaTags(data);
      }
    }

    async function fetchExperienceData() {
      try {
        const experienceId = "EX-1740739057483";

        if (!experienceId) {
          throw new Error("Experience ID not provided in URL");
        }

        const response = await fetch(
          `https://api.xperio.travel/app/experience/public/${experienceId}`,
          {
            headers: {
              "Cache-Control": "no-cache",
              "Pragma": "no-cache",
            },
          }
        );

        if (!response.ok) {
          throw new Error("Network response was not ok");
        }

        const data = await response.json();
        // Update Page Title
        document.title = data.title;

        return data;

      } catch (error) {
        console.error("Error fetching experience data:", error);
      }
    }

    async function fetchExperienceReviews(experienceId, offset = 0, pageSize = 10) {
      try {
        const response = await fetch(
          `https://api.xperio.travel/app/experience-review/public/review?experienceId=${experienceId}&offset=${offset}&pageSize=${pageSize}`,
          {
            headers: {
              "Cache-Control": "no-cache",
              "Pragma": "no-cache",
            },
          }
        );

        if (!response.ok) {
          throw new Error("Failed to fetch reviews");
        }

        return await response.json();
      } catch (error) {
        console.error("Error fetching experience reviews:", error);
        return { reviews: [], totalCount: 0 };
      }
    }


    function mapApiDataToExperience(apiData, reviewData) {
      return {
        id: apiData?.id || null,
        stars: apiData?.stars ? parseFloat(apiData.stars).toFixed(1) : "",
        hostName: apiData?.hostName || '',
        hostFirstName: apiData?.hostFirstName || "",
        hostLastName: apiData?.hostLastName || "",
        hostProfilePhoto: apiData?.hostProfilePhoto || '',
        coHostName: apiData?.coHostName || '',
        coHostProfilePhoto: apiData?.coHostProfilePhoto || '',
        title: apiData?.title || '',
        category: apiData?.category || '',
        subCategory: apiData?.subCategory || '',
        categoryList: apiData?.categoryList || [],
        village: apiData?.village || '',
        district: apiData?.district || '',
        state: apiData?.state || '',
        country: apiData?.country || '',
        guestType: apiData?.guestType || '',
        imageUrls: apiData?.imageUrls || [],
        keywords: apiData?.keywords || [],
        keyAttractions: apiData?.keyAttractions || '',
        briefOverview: apiData?.briefOverview || '',
        whatToExpect: apiData?.whatToExpect || '',
        whatsIncluded: apiData?.whatsIncluded || [],
        startDate: apiData?.startDate || null,
        endDate: apiData?.endDate || null,
        maxGuests: apiData?.maxGuests || 0,
        slotRanges: (apiData?.slotRanges || []).map((slot) => ({
          range: [slot?.range?.[0] || 0, slot?.range?.[1] || 0],
        })),
        complexity: apiData?.complexity || '',
        safetyAndAccessibility: (apiData?.safetyInstruction || []).join(', '),
        takeAway: apiData?.takeaway || '',
        cancellationPolicy: (apiData?.cancellationPolicies || []).map((policy) => ({
          days: policy?.days || 0,
          refund: policy?.percentage || 0,
        })),
        languages: apiData?.languageAssisted || [],
        instructionToReach: apiData?.notes || '',
        eventGeoPoint: {
          type: apiData?.eventGeoPoint?.type || 'Point',
          coordinates: apiData?.eventGeoPoint?.coordinates?.slice()?.reverse() || [0, 0],
        },
        address: apiData?.addressLine1 || '',
        meetingPoint: apiData?.addressLine2 || '',
        childrenAllowed: apiData?.isChildrenAllowed ?? false,
        activityRules: apiData?.rules || [],
        activityRulesDos: apiData?.dos || [],
        whatToBring: apiData?.whatToBring || '',
        amenities: apiData?.amenities || [],
        languageAssisted: apiData?.languageAssisted || [],
        foodAndDrinks: apiData?.foodAndDrinks || '',
        pricing: apiData?.pricing || [],
        immersive: apiData?.immersive || false,
        authenticity: apiData?.authenticity || false,
        localInteractions: apiData?.localInteractions || false,
        communityBenefits: apiData?.communityBenefits || false,
        sustainabilityPractices: apiData?.sustainabilityPractices || false,
        hostRating: apiData?.hostRating ? parseFloat(apiData.hostRating).toFixed(1) : "",
        hostReviews: apiData?.hostReviews || [],
        hostBriefAbout: apiData?.hostBriefAbout || '',
        isStayAvailable: apiData?.isStayAvailable ?? false,
        reviewData: reviewData?.data
      };
    }

    async function initializePage() {
      const app = document.getElementById("app");
      app.innerHTML = '<div class="loading-spinner"></div>';

      try {
        const experienceId = "EX-1740739057483";
        const apiData = await fetchExperienceData();
        const reviewData = await fetchExperienceReviews(experienceId);
        if (apiData) {
          window.experienceData = apiData;
          window.reviewsData = reviewData || { reviews: [], totalCount: 0 };

          const mappedData = mapApiDataToExperience(apiData, reviewData);
          renderExperience(mappedData);

          if (reviewData && reviewData.reviews && reviewData.reviews.length > 0) {
            renderReviews(reviewData);
          }
        } else {
          app.innerHTML = `
        <div class="error-message">
          Failed to load experience data. Please try again later.
        </div>
      `;
        }

        const slotButtons = document.getElementById("slotButtons");
        if (slotButtons && window.experienceData.slotRanges.length > 4) {
          slotButtons.style.display = "flex";
        }
      } catch (error) {
        console.error("Error initializing page:", error);
        app.innerHTML = `
      <div class="error-message">
        An error occurred while loading the page. Please try again later.
      </div>
    `;
      }
    }

    window.addEventListener("load", initializePage);


    function setupImageGallery() {
      // Image Gallery variables
      window.currentGallery = null;
      window.currentImageIndex = 0;

      // Image Gallery functions
      window.openImageGallery = function (galleryId, imageIndex) {
        const modal = document.getElementById('xpImageGalleryModal');
        const images = window.reviewGalleries[galleryId];

        if (!images || images.length === 0) return;

        window.currentGallery = galleryId;
        window.currentImageIndex = imageIndex;

        updateGalleryImage();
        createGalleryThumbnails(images);

        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
      };

      window.closeImageGallery = function () {
        const modal = document.getElementById('xpImageGalleryModal');
        modal.style.display = 'none';
        document.body.style.overflow = '';
      };

      window.navigateGallery = function (step) {
        const images = window.reviewGalleries[window.currentGallery];
        if (!images) return;

        window.currentImageIndex = (window.currentImageIndex + step + images.length) % images.length;
        updateGalleryImage();
      };

      window.updateGalleryImage = function () {
        const images = window.reviewGalleries[window.currentGallery];
        if (!images) return;

        const mainImage = document.getElementById('xpGalleryMainImage');
        mainImage.src = images[window.currentImageIndex];

        // Update counter
        document.getElementById('xpCurrentImageIndex').textContent = window.currentImageIndex + 1;
        document.getElementById('xpTotalImages').textContent = images.length;

        // Update active thumbnail
        const thumbnails = document.querySelectorAll('.xp-gallery-thumbnail');
        thumbnails.forEach((thumb, i) => {
          if (i === window.currentImageIndex) {
            thumb.classList.add('active');
          } else {
            thumb.classList.remove('active');
          }
        });

        // Scroll the active thumbnail into view if needed
        const activeThumb = document.querySelector('.xp-gallery-thumbnail.active');
        if (activeThumb) {
          const container = document.getElementById('xpGalleryThumbnails');
          const scrollLeft = activeThumb.offsetLeft - container.offsetLeft -
            (container.offsetWidth / 2) + (activeThumb.offsetWidth / 2);
          container.scrollTo({ left: scrollLeft, behavior: 'smooth' });
        }
      };

      window.createGalleryThumbnails = function (images) {
        const container = document.getElementById('xpGalleryThumbnails');
        container.innerHTML = '';

        images.forEach((src, index) => {
          const thumb = document.createElement('div');
          thumb.className = `xp-gallery-thumbnail ${index === window.currentImageIndex ? 'active' : ''}`;
          thumb.onclick = () => {
            window.currentImageIndex = index;
            updateGalleryImage();
          };

          const img = document.createElement('img');
          img.src = src;
          img.alt = 'Thumbnail';
          img.loading = 'lazy'; // Improve performance

          thumb.appendChild(img);
          container.appendChild(thumb);
        });
      };

      // Close modal when clicking outside the content
      window.addEventListener('click', function (event) {
        const modal = document.getElementById('xpImageGalleryModal');
        if (event.target === modal) {
          closeImageGallery();
        }
      });

      // Add keyboard navigation for gallery
      window.addEventListener('keydown', function (event) {
        if (document.getElementById('xpImageGalleryModal').style.display !== 'flex') return;

        if (event.key === 'ArrowLeft') {
          navigateGallery(-1);
        } else if (event.key === 'ArrowRight') {
          navigateGallery(1);
        } else if (event.key === 'Escape') {
          closeImageGallery();
        }
      });

      // Add swipe support for mobile
      let touchStartX = 0;
      let touchEndX = 0;

      const galleryMainImage = document.getElementById('xpGalleryMainImage');
      if (galleryMainImage) {
        galleryMainImage.addEventListener('touchstart', e => {
          touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });

        galleryMainImage.addEventListener('touchend', e => {
          touchEndX = e.changedTouches[0].screenX;
          handleSwipe();
        }, { passive: true });
      }

      function handleSwipe() {
        const minSwipeDistance = 50;
        if (touchEndX < touchStartX - minSwipeDistance) {
          // Swiped left
          navigateGallery(1);
        }
        if (touchEndX > touchStartX + minSwipeDistance) {
          // Swiped right
          navigateGallery(-1);
        }
      }
    }
    window.addEventListener("load", initializePage);

    function renderExperience(data) {
      const app = document.getElementById("app");

      app.innerHTML = `
  <div class="experience-header">
    <div class="header-content">
      <a href="https://xperio.travel/" style="text-decoration: none; color: inherit;">
        <div class="brand-container">
          <div class="brand-wrapper">
            <div class="logo-mark">
              <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/35Fp5UAUQrRYDop.png"
                  alt="Xperio Logo"
                  style="width: 30px; height: 30px; vertical-align: middle;">
              <span class="brand-name" style="font-size: 1rem; vertical-align: middle; margin-left: 0px;">Xperio</span>
            </div>
          </div>
        </div>
      </a>
      
      <div class="header-row">
        <div class="title-location">
  <!-- Title and Rating in one row -->
  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
    <h1 class="title" style="margin: 0; font-size: 24px;">${data.title}</h1>
    ${data.stars ? `
      <!-- Experience Rating - aligned directly beside title -->
      <div class="rating" style="display: flex; align-items: center; gap: 4px; background-color: #f8f8f8; padding: 3px 8px; border-radius: 16px; height: fit-content;">
        <span style="color: #FF9E00;">★</span>
        <span style="font-size: 14px; font-weight: 500;">${data.stars}</span>
      </div>
    ` : ''}
  </div>
  
  <!-- Location Information -->
  <div class="location" style="display: flex; align-items: center; gap: 10px; padding: 5px 0; border-radius: 8px; font-size: 14px; color: #333;">
    <!-- Location Icon -->
    <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/unapproved/experience/vRoXr0zMHBBZaAQ.jpeg"
         alt="Location Icon"
         style="width: 20px; height: 20px; object-fit: cover;">
    
    <!-- Location Details -->
    <span style="flex: 1; line-height: 1.4;">
      ${[data.village, data.district, data.state].filter(Boolean).join(", ")}
    </span>
  </div>
</div>
        
        <div class="categories-hosts desktop-only">
          <div class="hosts-section">
            <div class="host-card" onclick="openHostModal(window.experienceData)" style="display: flex; align-items: center; padding: 10px; background: #ffffff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: all 0.2s ease; cursor: pointer; border: 1px solid #f0f0f0;">
              <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${data.hostProfilePhoto}"
                  alt="Host"
                  style="width: 45px; height: 45px; border-radius: 50%; object-fit: cover; border: 2px solid #fff;">
              
              <div style="margin-left: 12px; display: flex; flex-direction: column;">
                <span style="font-size: 12px; color: #666; margin-bottom: 2px;">Host</span>
                <span style="font-size: 14px; font-weight: 600; color: #333; margin-bottom: 3px;">${data.hostFirstName} ${data.hostLastName}</span>
                
                ${data.hostRating ? `
                  <div style="display: flex; align-items: center; gap: 4px; background-color: #fff; padding: 2px 6px; border-radius: 12px; border: 1px solid #eee; align-self: flex-start;">
                    <span style="color: #FF9E00; font-size: 13px;">★</span>
                    <span style="font-size: 13px; font-weight: 600;">${data.hostRating}</span>
                  </div>
                ` : ''}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
`;


      const isMobile = window.innerWidth <= 768;
      app.innerHTML += `
          <div class="gallery-container">
            ${isMobile
          ? `
              <!-- Mobile Carousel View -->
              <div class="gallery-carousel">
                <div class="carousel-track">
                  ${data.imageUrls
            .map(
              (url, index) => `
                    <div class="carousel-slide" id="slide-${index}">
                      <img 
                        src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${url}" 
                        alt="Experience image ${index + 1}"
                        loading="${index < 2 ? "eager" : "lazy"}"
                      >
                    </div>
                  `
            )
            .join("")}
                </div>
                <div class="image-counter">
                  ${data.imageUrls.length > 0
            ? `${1}/${data.imageUrls.length}`
            : ""
          }
                </div>
                <div class="dots-container">
                  ${data.imageUrls
            .map(
              (_, index) => `
                    <div class="dot ${index === 0 ? "active" : ""
                }" data-index="${index}"></div>
                  `
            )
            .join("")}
                </div>
              </div>
            `
          : `
              <!-- Desktop Grid View -->
              <div class="gallery-grid">
                ${data.imageUrls
            .slice(0, 5)
            .map(
              (url, index) => `
                  <div class="gallery-image ${index === 0 ? "gallery-main" : ""
                }">
                    <img 
                      src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${url}" 
                      alt="Experience image ${index + 1}"
                      loading="lazy"
                    >
                  </div>
                `
            )
            .join("")}
              </div>
            `
        }
          </div>
        `;

      app.innerHTML += isMobile
        ? `
             <div class="info-card" style="background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); padding: 16px; margin: 10px 0; margin-bottom: 10px; margin-top: 50px;">
  <div class="categories-hosts">
    <div class="hosts-section">
      <div class="host-card" onclick="openHostModal(window.experienceData)">
        <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${data.hostProfilePhoto}" 
             alt="Host" 
             class="host-image">
        <div class="host-details">
          <span class="host-label">Hosted by</span>
          <span class="host-name">${data.hostFirstName} ${data.hostLastName}</span>
          ${data.hostRating ? `
                    <div class="rating" style="display: flex; align-items: center; gap: 4px; background-color: #fff; padding: 2px 8px; border-radius: 12px; border: 1px solid #eee;">
                      <span style="color: #FF9E00; font-size: 13px;">★</span>
                      <span style="font-size: 13px; font-weight: 600;">${data.hostRating}</span>
                    </div>
                  ` : ''}
        </div>
      </div>
    </div>
  </div>
</div>`
        : "";

      app.innerHTML += `
                    
            <div class="details-grid">
              <div class="left-column">

                <div class="section">
                  <div class="section-title">Brief Overview</div>
                  <div class="section-content">
                    ${data.briefOverview}
                  </div>
                </div>
                <div class="section">
                  <div class="section-title">Key Attraction</div>
                  <div class="section-content">
                    ${data.keyAttractions}
                  </div>
                </div>
                <div class="section">
                  <div class="section-title">What to Expect</div>
                  <div class="section-content">
                   <ul>
  ${data.whatToExpect
          .map((item) =>
            item.includes("Day")
              ? `<li style="list-style-type: none;"><b>${item}</b></li>`
              : `<li>${item}</li>`
          )
          .join("")}
</ul>
                  </div>
                </div>
                <div class="section">
                  <div class="section-title">What's Included</div>
                  <div class="section-content">
                    ${data.whatsIncluded}
                  </div>
                </div>

                <div class="section">
                <div class="section-title">Environment & Social Impact :</div>
                <div class="sub-section">
                  <div class="sub-section-title">Sustainability Practices :</div>
                  <div>${data.sustainabilityPractices}</div>
                </div>
                <div class="sub-section">
                  <div class="sub-section-title">Community Benefits :</div>
                  <div>${data.communityBenefits}</div>
                </div>
              </div>
              </div>
              
              <div class="right-column">          
                <div class="section">
                  <div class="section-title">Complexity</div>
                  <div class="section-content">
                    ${data.complexity}
                  </div>
                </div>
                <div class="section">
                  <div class="section-title">Safety and Accessibility</div>
                  <div class="section-content">
                    ${data.safetyAndAccessibility}
                  </div>
                </div>
                 <div class="section">
                <div class="section-title">Cultural Immersion:</div>
                <div class="sub-section scrollable-section">
                  <div class="sub-section-title">Local Interaction :</div>
                  <div>${data.localInteractions}</div>
                </div>
                <div class="sub-section scrollable-section">
                  <div class="sub-section-title">Authenticity :</div>
                  <div>${data.authenticity}</div>
                </div>
                <div class="sub-section scrollable-section">
                  <div class="sub-section-title">Immersive :</div>
                  <div>${data.immersive}</div>
                  </div>
                </div>

                <div class="section">
                <div class="section-title">Amenities :</div>
                <div class="amenities">
                  <ul class="amenities-list">
                    ${data.amenities
          ? data.amenities
            .map(
              (amenity) => `
                      <li class="amenity-item">
                        <span class="amenity-bullet">•</span>
                        <span class="amenity-text">${amenity}</span>
                      </li>
                    `
            )
            .join("")
          : "No amenities listed"
        }
                  </ul>
                  </div>
                </div>  

                <div class="section">
                <div class="section-title">Food and Drinks :</div>
                <div class="food-drinks">
                  ${data.foodAndDrinks
          ? data.foodAndDrinks
            .map(
              (item) => `
                    <div class="food-item">
                      <span class="amenity-bullet">•</span>
                      <span class="amenity-text">${item}</span>
                    </div>
                  `
            )
            .join("")
          : "No food and drinks included"
        }
                </div>               
            </div>


            <div class="section">
                <div class="icon-header">
                  <span class="rule-icon"></span>
                  <div class="section-title">What to Bring</div>
                </div>
                <ul class="bring-list">
                  ${data.whatToBring
          .map(
            (item) => `
                    <li class="bring-item">
                      <span class="bring-bullet">✓</span>
                      <span class="bring-text">${item}</span>
                    </li>
                  `
          )
          .join("")}
                </ul>
              </div>

              <div class="section">
                <div class="section-title">Categories : </div>
                  <div class="section-content">
                    ${data.categoryList
          ? data.categoryList
            .map(
              (category) => `
                    <span class="language-tag">${category}</span>
                  `
            )
            .join("")
          : "No languages specified"
        }  
                     
                </div>         
            </div>
          </div>


          

           <div class="section">
                <div class="section-title">Languages Assisted : </div>
                  <div class="section-content">
                    ${data.languageAssisted
          ? data.languageAssisted
            .map(
              (language) => `
                    <span class="language-tag">${language}</span>
                  `
            )
            .join("")
          : "No languages specified"
        }  
                     
                </div>         
            </div>

          <div class="section">
                  <div class="section-title">Guest Type:</div>
                  <div class="section-content">
                    ${data.guestType
          ? data.guestType
            .map(
              (guestType) => `
                    <span class="language-tag">${guestType}</span>
                  `
            )
            .join("")
          : "No Guest Type specified"
        }  
                     
                  </div>
                </div>
        `;

      app.innerHTML += `
          <div class="section map-section">
            <div class="section-title">Location Details</div>
            <div class="map-container">
              <iframe
                style="width: 100%; height: 350px; border: none;"
                src="//maps.google.com/maps?q=${data.eventGeoPoint.coordinates[0]},${data.eventGeoPoint.coordinates[1]}&z=13&output=embed"
              ></iframe>
              </div>

              <div class="location-details">
                <div class="address">
                <strong>Address:</strong> ${data.address}
              </div>
              <div class="meeting-point">
                <strong>Meeting Point:</strong> ${data.meetingPoint}
              </div>
               <div class="meeting-point">
                <strong>Instruction To Reach:</strong> ${data?.instructionToReach}
              </div>
            </div>
          </div>
        `;

      app.innerHTML += `
          <div class="section rules-section">
            <div class="rules-grid">
              <div class="rules-card children-allowed">
                <div class="icon-header">
                  <span class="rule-icon"></span>
                  <div class="section-title">Are Children Allowed?</div>
                </div>
                <div class="section-content status-indicator ${data.childrenAllowed ? "allowed" : "not-allowed"
        }">
                  ${data.childrenAllowed
          ? "Yes"
          : "No"
        }
                </div>
                <div style="padding-top: 20px"></div>
                 <div class="icon-header">
                  <span class="rule-icon"></span>
                  <div class="section-title">Is Accommodation Available?</div>
                </div>
                <div class="section-content status-indicator ${data.isStayAvailable ? "allowed" : "not-allowed"
        }">
                  ${data.isStayAvailable
          ? "Yes"
          : "No"
        }
                </div>
              </div>

              <div class="rules-card activity-rules">
                <div class="icon-header">
                  <span class="rule-icon">📋</span>
                  <div class="section-title">Activity Rules - Do's</div>
                </div>
                <ul class="rules-list">
                  ${data.activityRulesDos
          .map(
            (rule) => `
                    <li class="rule-item">
                      <span class="rule-bullet">•</span>
                      <span class="rule-text">${rule}</span>
                    </li>
                  `
          )
          .join("")}
                </ul>
              </div>

              <div class="rules-card activity-rules">
                <div class="icon-header">
                  <span class="rule-icon">📋</span>
                  <div class="section-title">Activity Rules - Don'ts</div>
                </div>
                <ul class="rules-list">
                  ${data.activityRules
          .map(
            (rule) => `
                    <li class="rule-item">
                      <span class="rule-bullet">•</span>
                      <span class="rule-text">${rule}</span>
                    </li>
                  `
          )
          .join("")}
                </ul>
              </div>

              
            </div>
          </div>
          <div style="height: 20px;"></div> 
           <div class="section">
              <div class="section-title">Take Away</div>
              <div class="section-content">
              ${data.takeAway}
              </div>
            </div>

            <div class="policy-and-slots-container">
            <div class="booking-slots-container">
              <h4 class="slots-title">📅 Available Time Slots</h4>
              <div class="slots-wrapper" id="slotsWrapper">
                ${data.slotRanges
          .slice(0, 4) // Limit to the first four slots
          .map((slot) => {
            const checkIn = new Date(slot.range[0]);
            const checkOut = new Date(slot.range[1]);
            return `
                    <div class="slot-card">
                      <div class="slot-times">
                        <div class="time-block">
                          <div class="time-icon">
                             <div class="slot-day">${checkIn.toLocaleDateString(
              undefined,
              {
                weekday: "short",
                month: "short",
                day: "numeric",
              }
            )}</div> 
                          </div>
                          <div class="time-details">
                            <span class="time-label">Check-in</span>
                            <span class="time">${checkIn.toLocaleTimeString(
              [],
              {
                hour: "2-digit",
                minute: "2-digit",
              }
            )}</span>
                          </div>
                        </div>
                        <div class="time-divider">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M5 12h14m-7-7l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                        </div>
                        <div class="time-block">
                          <div class="time-icon">
                           <div class="slot-day">${checkOut.toLocaleDateString(
              undefined,
              {
                weekday: "short",
                month: "short",
                day: "numeric",
              }
            )}</div>  
                          </div>
                          <div class="time-details">
                            <span class="time-label">Check-out</span>
                            <span class="time">${checkOut.toLocaleTimeString(
              [],
              {
                hour: "2-digit",
                minute: "2-digit",
              }
            )}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  `;
          })
          .join("")}
              </div>
              
              <div style="display: flex; justify-content: center; margin-bottom: 20px;" id="slotButtons" style="display: ${window.experienceData.slotRanges.length > 4 ? 'flex' : 'none'};">
                <button id="showMoreButton" class="submit-button" onclick="showMoreSlots()" style="padding: 8px 16px; width: 20rem; margin-top: 10px; display: ${window.experienceData.slotRanges.length > 4 ? 'flex' : 'none'}">
                    Show More <span class="button-icon">⬇️</span>
                </button>
                <button id="showLessButton" class="submit-button" onclick="showLessSlots()" style="padding: 8px 16px; width: 20rem; margin-top: 10px; display: none;">
                    Show Less <span class="button-icon">⬆️</span>
                </button>
              </div>


              <div class="pricing-policy-grid">
                <div class="section pricing-section">
                  <h3 class="section-title">Pricing Details</h3>
                  <table class="pricing-table">
                    ${data.pricing
          .map(
            (price) => `
                      <tr>
                        <td>${price.guestCount} Guest${price.guestCount > 1 ? "s" : ""
              }</td>
                        <td>₹${price.totalPrice}</td>
                      </tr>
                    `
          )
          .join("")}
                  </table>
                </div>

                <div class="section pricing-section">
                  <h3 class="section-title">Cancellation Policy</h3>
                  <div class="policy-content">
                    ${data.cancellationPolicy
          .map(
            (policy) => `
                      <div class="policy-item">
                        <span>${policy.days}${policy.days === 1 ? " day" : " days"
              } prior</span>
                        <span>${policy.refund}% refund</span>
                      </div>
                    `
          )
          .join("")}
                  </div>
                </div>
              </div>
            </div>

            ${data?.reviewData?.length !== 0 ? `
    <div class="section reviews-section">
      <div class="section-title">Guest Reviews</div>
      <div class="xp-reviews-container">
        <div class="xp-reviews-scroll">
          ${data.reviewData.map((review, index) => `
            <div class="xp-review-card">
              <div class="xp-review-header">
                <div class="xp-reviewer-info">
                  <div class="xp-reviewer-avatar">
                    ${review.guestProfilePicture 
                      ? `<img src="${review.guestProfilePicture}" alt="${review.guestName}">`
                      : `<div class="xp-avatar-placeholder">${review.guestName.charAt(0)}</div>`
                    }
                  </div>
                  <div class="xp-reviewer-details">
                    <div class="xp-reviewer-name">${review.guestName}</div>
                    <div class="xp-review-date">
                      ${new Date(review.ratingDate).toLocaleDateString(undefined, {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                      })}
                    </div>
                  </div>
                </div>
                <div class="xp-rating">
                  ${'★'.repeat(review.ratingCount)}${'☆'.repeat(5 - review.ratingCount)}
                </div>
              </div>
              <div class="xp-review-content">
                <p>${review.comment}</p>
              </div>
              ${review.imageUrls && review.imageUrls.length > 0 ? `
                <div class="xp-review-images">
                  ${review.imageUrls.slice(0, 3).map((image, imgIndex) => `
                    <div class="xp-review-image-container" onclick="openImageGallery('review-${index}', ${imgIndex})">
                      <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${image}" alt="Review Image" class="xp-review-image">
                    </div>
                  `).join('')}
                  ${review.imageUrls.length > 3 ? `
                    <div class="xp-review-image-container xp-more-images-container" onclick="openImageGallery('review-${index}', 3)">
                      <img src="https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${review.imageUrls[3]}" alt="Review Image" class="xp-review-image">
                      <div class="xp-more-images">+${review.imageUrls.length - 4}</div>
                    </div>
                  ` : ''}
                </div>
              ` : ''}
              <div class="xp-review-highlights">
                <div class="xp-highlight-item">
                  <strong>Most enjoyable:</strong> ${review.mostEnjoyablePart.slice(1).join(', ')}
                </div>
              </div>
            </div>
          `).join('')}
        </div>
        <div class="xp-scroll-buttons">
          <button class="xp-scroll-button left" onclick="scrollReviews('left')">❮</button>
          <button class="xp-scroll-button right" onclick="scrollReviews('right')">❯</button>
        </div>
      </div>
    </div>
  ` : `
    <div class="section reviews-section">
      <div class="section-title">Guest Reviews</div>
      <div class="xp-no-reviews">
        <p>No reviews available for this experience yet. Be the first to leave a review!</p>
      </div>
    </div>
  `}

<!-- Image Gallery Modal -->
<div id="xpImageGalleryModal" class="xp-image-gallery-modal">
  <span class="xp-close-modal" onclick="closeImageGallery()">&times;</span>
  <div class="xp-gallery-content">
    <div class="xp-gallery-main-image">
      <img id="xpGalleryMainImage" src="" alt="Gallery Image">
    </div>
    <div class="xp-gallery-navigation">
      <button class="xp-gallery-nav-button prev" onclick="navigateGallery(-1)">❮</button>
      <div class="xp-gallery-thumbnails" id="xpGalleryThumbnails"></div>
      <button class="xp-gallery-nav-button next" onclick="navigateGallery(1)">❯</button>
    </div>
    <div class="xp-image-counter">
      <span id="xpCurrentImageIndex">1</span>/<span id="xpTotalImages">1</span>
    </div>
  </div>
</div>
            
          <div class="disclaimer-section">
            <div class="disclaimer-content">
              <strong>Note:</strong> At Xperio, we strive to ensure that every experience meets your expectations and creates memorable moments. However, certain factors beyond our control, such as weather conditions, local regulations, health advisories, or host unavailability, may lead to modifications, delays, or, in rare cases, cancellations of planned activities.
            </div>
          </div>
           <div style="height: 20px;"></div> 

           
        `;

        window.reviewGalleries = {};
      if (data.reviewData && data.reviewData.length > 0) {
        data.reviewData.forEach((review, index) => {
          if (review.imageUrls && review.imageUrls.length > 0) {
            window.reviewGalleries[`review-${index}`] = review.imageUrls.map(image =>
              `https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${image}`
            );
          }
        });
      }

      setupImageGallery();
      window.scrollReviews = function (direction) {
        const container = document.querySelector('.reviews-scroll');
        const cardWidth = document.querySelector('.review-card').offsetWidth + 20; // Add gap

        if (direction === 'left') {
          container.scrollBy({ left: -cardWidth, behavior: 'smooth' });
        } else {
          container.scrollBy({ left: cardWidth, behavior: 'smooth' });
        }
      };

      if (isMobile) {
        const track = document.querySelector(".carousel-track");
        const dots = document.querySelectorAll(".dot");
        const counter = document.querySelector(".image-counter");
        let currentIndex = 0;
        const updateIndicators = (index) => {
          dots.forEach((dot, i) => {
            dot.classList.toggle("active", i === index);
          });
          counter.textContent = `${index + 1}/${dots.length}`;
        };
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const slideIndex = parseInt(entry.target.id.split("-")[1]);
                currentIndex = slideIndex;
                updateIndicators(slideIndex);
              }
            });
          },
          {
            root: track,
            threshold: 0.5,
          }
        );

        document.querySelectorAll(".carousel-slide").forEach((slide) => {
          observer.observe(slide);
        });

        dots.forEach((dot, index) => {
          dot.addEventListener("click", () => {
            const slideElement = document.getElementById(`slide-${index}`);
            slideElement.scrollIntoView({
              behavior: "smooth",
              inline: "start",
            });
            currentIndex = index;
            updateIndicators(index);
          });
        });
        track.addEventListener("click", (e) => {
          const rect = track.getBoundingClientRect();
          const x = e.clientX - rect.left;

          if (x > rect.width / 2 && currentIndex < dots.length - 1) {
            currentIndex++;
          } else if (x <= rect.width / 2 && currentIndex > 0) {
            currentIndex--;
          }

          document.getElementById(`slide-${currentIndex}`).scrollIntoView({
            behavior: "smooth",
            inline: "start",
          });
          updateIndicators(currentIndex);
        });
      }

      // Initialize lightbox after rendering gallery
      if (window.innerWidth > 768) {
        initializeLightbox(data.imageUrls);
      }
    }

    let currentIndex = 4; // Start from the 5th item
    let isSlotsExpanded = false; // Track the state of the slots

    function showMoreSlots() {
      const slotsWrapper = document.getElementById("slotsWrapper");
      if (!slotsWrapper) {
        console.error("slotsWrapper element not found");
        return;
      }

      // Expand the slots
      const additionalSlots = window.experienceData.slotRanges.slice(currentIndex, currentIndex + 4);
      if (additionalSlots.length > 0) {
        const newSlotsHTML = additionalSlots.map((slot) => {
          const checkIn = new Date(slot.range[0]);
          const checkOut = new Date(slot.range[1]);
          return `
              <div class="slot-card">
                <div class="slot-times">
                  <div class="time-block">
                    <div class="time-icon">
                      <div class="slot-day">${checkIn.toLocaleDateString(undefined, { weekday: "short", month: "short", day: "numeric" })}</div> 
                    </div>
                    <div class="time-details">
                      <span class="time-label">Check-in</span>
                      <span class="time">${checkIn.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</span>
                    </div>
                  </div>
                  <div class="time-divider">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M5 12h14m-7-7l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                  <div class="time-block">
                    <div class="time-icon">
                      <div class="slot-day">${checkOut.toLocaleDateString(undefined, { weekday: "short", month: "short", day: "numeric" })}</div>  
                    </div>
                    <div class="time-details">
                      <span class="time-label">Check-out</span>
                      <span class="time">${checkOut.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</span>
                    </div>
                  </div>
                </div>
              </div>
            `;
        }).join("");

        slotsWrapper.innerHTML += newSlotsHTML; // Append new slots
        currentIndex += 4; // Update the current index

        // Show "Show Less" button if maximum length is reached
        if (currentIndex >= window.experienceData.slotRanges.length) {
          document.getElementById("showMoreButton").style.display = "none";
          document.getElementById("showLessButton").style.display = "block";
        }
      }

      isSlotsExpanded = true; // Set the state to expanded
    }

    function showLessSlots() {
      const slotsWrapper = document.getElementById("slotsWrapper");
      if (!slotsWrapper) {
        console.error("slotsWrapper element not found");
        return;
      }

      // Collapse the slots
      slotsWrapper.innerHTML = ''; // Clear the slots
      currentIndex = 4; // Reset to show the first four slots
      const initialSlots = window.experienceData.slotRanges.slice(0, currentIndex); // Get the first four slots
      const initialSlotsHTML = initialSlots.map((slot) => {
        const checkIn = new Date(slot.range[0]);
        const checkOut = new Date(slot.range[1]);
        return `
          <div class="slot-card">
            <div class="slot-times">
              <div class="time-block">
                <div class="time-icon">
                  <div class="slot-day">${checkIn.toLocaleDateString(undefined, { weekday: "short", month: "short", day: "numeric" })}</div> 
                </div>
                <div class="time-details">
                  <span class="time-label">Check-in</span>
                  <span class="time">${checkIn.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</span>
                </div>
              </div>
              <div class="time-divider">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path d="M5 12h14m-7-7l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div class="time-block">
                <div class="time-icon">
                  <div class="slot-day">${checkOut.toLocaleDateString(undefined, { weekday: "short", month: "short", day: "numeric" })}</div>  
                </div>
                <div class="time-details">
                  <span class="time-label">Check-out</span>
                  <span class="time">${checkOut.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</span>
                </div>
              </div>
            </div>
          </div>
        `;
      }).join("");

      slotsWrapper.innerHTML = initialSlotsHTML; // Show the initial slots
      document.getElementById("showMoreButton").style.display = "block"; // Show "Show More" button
      document.getElementById("showLessButton").style.display = "none"; // Hide "Show Less" button

      isSlotsExpanded = false; // Set the state to collapsed
    }

    function openDialog(slotId) {
      const dialog = document.getElementById("bookingDialog");
      const guestCountSelect = document.getElementById("guestCount");
      const slotRangeSelect = document.getElementById("slotRange");
      const bookNowButton = document.getElementById("bookNowButton"); // Get the button

      // Hide the button
      bookNowButton.style.display = 'none';

      // Clear existing options
      guestCountSelect.innerHTML = "";
      slotRangeSelect.innerHTML = "<option value=''>Select a slot</option>";

      const apiData = window.experienceData;

      // Populate guest count options
      apiData.pricing.forEach((price) => {
        const option = document.createElement("option");
        option.value = price.guestCount;
        option.textContent = `${price.guestCount} Guest${price.guestCount > 1 ? "s" : ""
          } - ₹${price.totalPrice}`;
        guestCountSelect.appendChild(option);
      });

      // Populate slot range options
      apiData.slotRanges.forEach((slot, index) => {
        const checkIn = new Date(slot.range[0]);
        const checkOut = new Date(slot.range[1]);

        const option = document.createElement("option");
        option.value = slot.slotId;
        option.textContent = `${checkIn.toLocaleDateString(undefined, {
          weekday: "short",
          month: "short",
          day: "numeric",
        })} - ${checkIn.toLocaleTimeString([], {
          hour: "2-digit",
          minute: "2-digit",
        })} to ${checkOut.toLocaleDateString(undefined, {
          weekday: "short",
          month: "short",
          day: "numeric",
        })} - ${checkOut.toLocaleTimeString([], {
          hour: "2-digit",
          minute: "2-digit",
        })}`;
        slotRangeSelect.appendChild(option);
      });

      document.getElementById("slotId").value = slotId;
      dialog.style.display = "flex";
    }

    function closeDialog() {
      const bookNowButton = document.getElementById("bookNowButton");
      bookNowButton.style.display = 'block';
      document.getElementById("bookingDialog").style.display = "none";
      document.getElementById("bookingForm").reset();
    }

    async function submitBooking(event) {
      event.preventDefault();

      const firstNameInput = document.getElementById("firstName");
      const lastNameInput = document.getElementById("lastName");
      const phoneInput = document.getElementById("phone");
      const emailInput = document.getElementById("email");
      const guestCountInput = document.getElementById("guestCount");
      const slotIdInput = document.getElementById("slotRange");

      // Clear any previous error styling
      [firstNameInput, lastNameInput, phoneInput, emailInput, guestCountInput].forEach(
        (input) => {
          input.style.borderColor = "#e2e8f0";
        }
      );

      // Validate required fields
      let hasError = false;
      const errors = [];

      if (!firstNameInput.value.trim()) {
        firstNameInput.style.borderColor = "#dc3545";
        errors.push("First Name is required");
        hasError = true;
      }

      if (!lastNameInput.value.trim()) {
        lastNameInput.style.borderColor = "#dc3545";
        errors.push("Last Name is required");
        hasError = true;
      }

      if (!phoneInput.value.trim()) {
        phoneInput.style.borderColor = "#dc3545";
        errors.push("Phone number is required");
        hasError = true;
      } else if (!/^[0-9]{10}$/.test(phoneInput.value.trim())) {
        phoneInput.style.borderColor = "#dc3545";
        errors.push("Please enter a valid 10-digit phone number");
        hasError = true;
      }

      if (!emailInput.value.trim()) {
        emailInput.style.borderColor = "#dc3545";
        errors.push("Email is required");
        hasError = true;
      } else if (
        !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value.trim())
      ) {
        emailInput.style.borderColor = "#dc3545";
        errors.push("Please enter a valid email address");
        hasError = true;
      }

      if (!guestCountInput.value) {
        guestCountInput.style.borderColor = "#dc3545";
        errors.push("Please select number of guests");
        hasError = true;
      }

      const experienceId = "EX-1740739057483"
      if (!experienceId) {
        errors.push("Experience ID is missing");
        hasError = true;
      }

      if (!slotIdInput.value) {
        errors.push("Slot ID is missing");
        hasError = true;
      }

      if (hasError) {
        alert("Please correct the following errors:\n" + errors.join("\n"));
        return;
      }

      // If validation passes, prepare form data
      const formData = {
        firstName: firstNameInput.value.trim(),
        lastName: lastNameInput.value.trim(),
        phone: phoneInput.value.trim(),
        phoneNumberPrefix: "+91",
        email: emailInput.value.trim(),
        experienceId: experienceId,
        experienceTitle: document.querySelector(".title").textContent,
        slotId: slotIdInput.value,
        guestCount: parseInt(guestCountInput.value),
      };

      try {
        const response = await fetch(
          "https://api.xperio.travel/app/experience/public/enquire",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              accept: "application/x-ndjson",
            },
            body: JSON.stringify(formData),
          }
        );

        if (!response.ok) {
          throw new Error("Booking failed");
        }

        alert("Booking submitted successfully!");
        closeDialog();
      } catch (error) {
        alert("Failed to submit booking. Please try again.");
      }
    }

    // Add this function to get the minimum price from pricing data
    function getMinPrice() {
      const apiData = window.experienceData;
      if (apiData && apiData.pricing && apiData.pricing.length > 0) {
        const prices = apiData.pricing.map((p) => p.price);
        return Math.min(...prices).toLocaleString("en-IN");
      }
      return "0";
    }

    function openHostModal(data) {
      const modal = document.getElementById('hostModal');
      const hostImage = document.getElementById('modalHostImage');
      const hostName = document.getElementById('modalHostName');
      const hostFirstName = document.getElementById('modalHostName');
      const hostLastName = document.getElementById('modalHostName');
      const hostRating = document.getElementById('modalHostRating');
      const hostBrief = document.getElementById('modalHostBrief');
      // const hostReviews = document.getElementById('modalHostReviews');

      // Set host image and name
      hostImage.src = `https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${data.hostProfilePhoto}`;
      hostName.textContent = data.hostFirstName + " " + data.hostLastName;

      // Format rating to one decimal place
      // const rating = parseFloat(data.hostRating).toFixed(1);

      // Create star rating HTML with precise fill
      // const starRatingHTML = `
      //     <div class="stars-container">
      //       ${[1, 2, 3, 4, 5].map(index => {
      //   const fillPercentage = Math.min(Math.max((rating - (index - 1)) * 100, 0), 100);
      //   return `
      //           <div class="star" style="--fill: ${fillPercentage}%">★</div>
      //         `;
      // }).join('')}
      //     </div>
      //     <span class="rating-number">${rating}</span>
      //   `;

      // hostRating.innerHTML = starRatingHTML;

      // Set host brief
      hostBrief.textContent = data.hostBriefAbout || 'No description available';

      // Set host reviews
      // const reviewsContainer = hostReviews.querySelector('.reviews-container');
      // reviewsContainer.innerHTML = '';

      // if (data.hostReviews && data.hostReviews.length > 0) {
      //   data.hostReviews.forEach(review => {
      //     const reviewElement = document.createElement('div');
      //     reviewElement.className = 'review-item';
      //     reviewElement.innerHTML = `
      //         <div class="review-header">
      //           <div class="reviewer-info">
      //             <div class="reviewer-name">${review.guestName}</div>
      //             <div class="review-date">${new Date(review.date).toLocaleDateString()}</div>
      //           </div>
      //         </div>
      //         <div class="review-content">${review.comment}</div>
      //       `;
      //     reviewsContainer.appendChild(reviewElement);
      //   });
      // } else {
      //   reviewsContainer.innerHTML = '<p>No reviews yet</p>';
      // }

      modal.style.display = 'flex';
    }

    function closeHostModal() {
      document.getElementById('hostModal').style.display = 'none';
    }

    // Close modal when clicking outside
    document.addEventListener('click', (e) => {
      const modal = document.getElementById('hostModal');
      if (e.target === modal) {
        closeHostModal();
      }
    });

    function fetchReviews(reviews, container) {
      container.innerHTML = '';

    }

    function initializeLightbox(images) {
      const lightbox = document.getElementById('lightbox');
      const lightboxImage = document.getElementById('lightbox-image');
      const counter = document.querySelector('.lightbox-counter');
      let currentIndex = 0;
      let currentScale = 1;

      // Add click handlers to gallery images
      document.querySelectorAll('.gallery-grid .gallery-image img').forEach((img, index) => {
        img.addEventListener('click', () => openLightbox(index));
      });

      function openLightbox(index) {
        currentIndex = index;
        currentScale = 1;
        updateImage();
        lightbox.style.display = 'block';
        document.body.style.overflow = 'hidden';
      }

      function updateImage() {
        const imageUrl = `https://wsrv.nl/?url=https://xperio-images.s3.ap-south-1.amazonaws.com//xperio/${images[currentIndex]}`;
        lightboxImage.src = imageUrl;
        lightboxImage.style.transform = `scale(${currentScale})`;
        counter.textContent = `${currentIndex + 1} / ${images.length}`;
      }

      // Navigation
      document.querySelector('.prev-button').addEventListener('click', () => {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        currentScale = 1;
        updateImage();
      });

      document.querySelector('.next-button').addEventListener('click', () => {
        currentIndex = (currentIndex + 1) % images.length;
        currentScale = 1;
        updateImage();
      });

      // Zoom controls
      document.querySelector('.zoom-in').addEventListener('click', () => {
        currentScale = Math.min(currentScale + 0.5, 3);
        updateImage();
      });

      document.querySelector('.zoom-out').addEventListener('click', () => {
        currentScale = Math.max(currentScale - 0.5, 1);
        updateImage();
      });

      // Close lightbox
      document.querySelector('.lightbox-close').addEventListener('click', () => {
        lightbox.style.display = 'none';
        document.body.style.overflow = '';
      });

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (lightbox.style.display === 'block') {
          switch (e.key) {
            case 'ArrowLeft':
              currentIndex = (currentIndex - 1 + images.length) % images.length;
              currentScale = 1;
              updateImage();
              break;
            case 'ArrowRight':
              currentIndex = (currentIndex + 1) % images.length;
              currentScale = 1;
              updateImage();
              break;
            case 'Escape':
              lightbox.style.display = 'none';
              document.body.style.overflow = '';
              break;
          }
        }
      });

      // Add mouse wheel zoom
      lightboxImage.addEventListener('wheel', (e) => {
        e.preventDefault();
        if (e.deltaY < 0) {
          currentScale = Math.min(currentScale + 0.1, 3);
        } else {
          currentScale = Math.max(currentScale - 0.1, 1);
        }
        updateImage();
      });
    }
  </script>
</body>

</html>